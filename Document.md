# Documentation

Documentation is a big part of STIG compliance. This usually takes the form of generating a STIG checklist that can be viewed in the STIG Viewer that is provided by DISA. PowerSTIG improves on this process by enabling you to generate a STIG checklist from either a compiled .MOF file or the DSC results generated from a target that has been configured with DSC. Here's what gets generated:

* Accurate status is reported for vulnerabilities that are to be addressed by PowerSTIG (.MOF) or that are compliant (DSC results).
* Finding Details and Comments are populated with information as to how/what was/will be applied.
* Org settings are reflected in what is reported.
* Manual entries from a file are injected into the checklist showing the Status, Finding Details and Comments so that vulnerabilities that haven't been automated can be reported.

STIG details are not carried forward in the PowerStig processed data files, so it is necessary to provide the raw STIG file so that the extra details can be added to the checklist file. This is either done by passing in a reference to an XCCDF file or a file with a list of XCCDF files in it.

## Generating a checklist from a MOF

To validate MOF before you deploy it, you can create a checklist from it by running the following command.

```powershell
$ReferenceConfiguration = ".\reference.mof"
$XccdfPath = '.\U_Windows_2012_and_2012_R2_MS_STIG_V2R12_Manual-xccdf.xml'
$outputPath = ".\checklist.ckl"

New-StigCheckList -ReferenceConfiguration $ReferenceConfiguration -XccdfPath $XccdfPath -OutputPath $outputPath
```

## Generate a checklist from the DSC results

Once a configuration is deployed to a server, you can generate checklists directly from the Test-DscConfiguration results.

```powershell
$DscResults = Test-DsCconfiguration -ComputerName localhost -Detailed
$XccdfPath  = '.\U_Windows_2012_and_2012_R2_MS_STIG_V2R12_Manual-xccdf.xml'
$outputPath = ".\checklist.ckl"

New-StigCheckList -DscResult $DscResults -XccdfPath $XccdfPath -OutputPath $outputPath
```

## Generate a checklist for an endpoint for multiple STIGs

It is common for a checklist to be created for all of the STIGs that apply to an endpoint, computer, or server. This is done by calling New-StigChecklist with a different set of parameters, similar to what is listed above.

```powershell
New-StigCheckList -MofFile $MofFile -ChecklistSTIGFiles $ChecklistSTIGFiles -OutputPath $outputPath
New-StigCheckList -DscResults $DscResults -ChecklistSTIGFiles $ChecklistSTIGFiles -OutputPath $outputPath
```
This is a simple list of the paths to STIGs that should be checked. See a sample at /PowerShell/StigData/Samples/ChecklistSTIGFiles.txt.

## Inject manual entries into a checklist

While PowerSTIG automates a high percentage of vulnerabilities for supported STIGs, there is usually a set of vulnerabilities that are not automated. A checklist generated from PowerSTIG will report a status of 'Not Reviewed' for these rules. However, these rules can be populated at the time the checklist is generated by adding a manual checklist entries file as a parameter when generating a checklist. The command(s) look like this:

```powershell
New-StigCheckList -MofFile $MofFile -ChecklistSTIGFiles $ChecklistSTIGFiles -OutputPath $outputPath -ManualChecklistEntries $ManualChecklistEntriesFile
New-StigCheckList -DscResults $DscResults -ChecklistSTIGFiles $ChecklistSTIGFiles -OutputPath $outputPath -ManualChecklistEntries $ManualChecklistEntriesFile
```
The manual checklist entries file is an XML file that can be created manually or by exporting an Excel worksheet as XML. The file format should look like the following:

        <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <ManualChecklistEntries xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	        <VulID id="V-79119" Status="NotAFinding">
		        <Details>See System Security Document.</Details>
		        <Comments>This is a test of a manual check file entry.</Comments>
	        </VulID>
        </ManualChecklistEntries>
        
For your convenience, you can see a sample at /PowerShell/StigData/Samples/ManualCheckListEntriesExcelExport.xml.
